<!-- src/app/dashboard/dashboard.html -->
<div class="dashboard-header">
  <h2>AgentWealth</h2>
  <div class="tabs">
    <button 
      (click)="selectTab('agent')" 
      [class.active]="activeTab() === 'agent'">
      ğŸš€ Agent Dashboard
    </button>
    <button 
      (click)="selectTab('learning')" 
      [class.active]="activeTab() === 'learning'">
      ğŸ“š Learning Center
    </button>
    <button 
      (click)="selectTab('finance')" 
      [class.active]="activeTab() === 'finance'">
      ğŸ“ˆ Trading Sandbox
    </button>
    <button 
      (click)="selectTab('chat')" 
      [class.active]="activeTab() === 'chat'">
      ğŸ’¬ Chat with AI
    </button>

    <!-- New account/person icon button might remove later -->


  </div>
<div class="account-controls">
  <div class="dropdown">
 <button class="account-btn" (click)="selectedDropdown.set(selectedDropdown() === 'account' ? null : 'account')">
      ğŸ‘¤
    </button>
    <!-- Dropdown menu -->
    <div class="dropdown-content" *ngIf="selectedDropdown() === 'account'">
      <a href="#" (click)="$event.preventDefault(); selectedDropdown.set('account')">Account Details</a>
      <a href="#" (click)="$event.preventDefault(); selectedDropdown.set('settings')">Settings</a>
      <a href="#" (click)="$event.preventDefault(); selectedDropdown.set('privacy')">Privacy Policy</a>
    </div>
  </div>

  <button class="logout-btn" (click)="logout()">Logout</button>
</div>
</div>

<!-- Modern Angular 20+ Control Flow -->
@switch (activeTab()) {
  @case ('agent') {
    <app-agent-dashboard></app-agent-dashboard>
  }
  @case ('learning') {
    <app-learning-page></app-learning-page>
  }
  @case ('finance') {
    <app-digital-financial-literacy></app-digital-financial-literacy>
  }
  @case ('chat') {
    <div class="chat-wrapper">
      <div id="chat-container" class="chat-container">
        @for (message of messages(); track message.timestamp) {
          <div class="message-wrapper" 
               [class.user-message]="message.sender === 'user'"
               [class.ai-message]="message.sender === 'ai'">
            <div class="message-content">
              <span class="message-text">{{ message.text }}</span>
              @if (message.agentType) {
                <span class="agent-tag">{{ message.agentType }}</span>
              }
              <span class="message-time">
                {{ message.timestamp | date:'short' }}
              </span>
            </div>
          </div>
        }
        
        @if (isLoading()) {
          <div class="ai-message loading-message">
            <div class="typing-indicator">
              <span></span>
              <span></span>
              <span></span>
            </div>
          </div>
        }
      </div>
      
      <div class="chat-input">
        <input 
          type="text" 
          [value]="userInput()"
          (input)="updateUserInput($any($event.target).value)"
          placeholder="Ask about financial literacy, assessments, or learning paths..." 
          (keyup.enter)="sendMessage()"
          [disabled]="isLoading()"/>
        <button 
          (click)="sendMessage()"
          [disabled]="!canSendMessage()">
          @if (isLoading()) {
            Sending...
          } @else {
            Send
          }
        </button>
      </div>
      
      @if (!userId()) {
        <div class="auth-warning">
          <p>âš ï¸ Please log in to start your financial literacy journey</p>
        </div>
      }
    </div>
  }
}

<div class="dropdown-content" *ngIf="selectedDropdown() === 'account'">
  <app-account-details></app-account-details>
</div>

<div class="dropdown-content" *ngIf="selectedDropdown() === 'settings'">
  <app-settings></app-settings>
</div>

<div class="dropdown-content" *ngIf="selectedDropdown() === 'privacy'">
  <app-privacy-policy></app-privacy-policy>
</div>